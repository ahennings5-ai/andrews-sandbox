generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Run logs for marathon training
model RunLog {
  id          String   @id @default(cuid())
  week        Int
  day         Int
  date        String
  actualMiles Float
  duration    String
  pace        String
  feeling     String
  notes       String   @default("")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([week, day])
}

// Meal plan for the week
model MealPlan {
  id           String   @id @default(cuid())
  weekOf       String   @unique // ISO date of the Monday
  planData     Json     // The full week plan as JSON
  checkedItems Json     @default("{}") // Grocery items checked off
  attendance   Json?    // Who's eating each day [{andrew: bool, olivia: bool}, ...]
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// Track meal preferences (likes/dislikes)
model MealPreference {
  id        String   @id @default(cuid())
  mealId    String   // e.g., "b1", "l2", "d5"
  mealType  String   // "breakfast", "lunch", "dinner", "snack"
  mealName  String   // Human readable name
  rating    Int      // 1 = dislike, 2 = like
  person    String?  // "andrew", "olivia", or null for household
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([mealId, person])
}

// Business idea pipeline
model BusinessIdea {
  id          String   @id @default(cuid())
  
  // Layer 1 - Quick pitch
  name        String
  oneLiner    String
  category    String   // service, product, local, arbitrage, b2b
  source      String   // Where I found this signal
  whyNow      String   // Why this opportunity exists now
  
  // Scores (1-5 scale)
  scores      Json     // { startupCost, timeToRevenue, scalability, moat, timing, effort }
  
  // Personal fit scores
  personalFit Json     // { hoursPerWeek, skillsMatch, networkLeverage }
  
  // Status: new -> researched -> ready -> archived
  status      String   @default("new")
  layer       Int      @default(1) // 1, 2, or 3
  
  // Layer 2 - Business Case (populated after first upvote)
  businessCase Json?   // { marketSize, targetCustomer, businessModel, startupCosts, unitEconomics, projections, competitors, risks }
  
  // Layer 3 - Execution Plan (populated after second upvote)
  executionPlan Json?  // { weekByWeek, hurdles, hireOrOutsource, mvpVsFull, cashRunway, killCriteria }
  
  // User notes
  notes       String   @default("")
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
